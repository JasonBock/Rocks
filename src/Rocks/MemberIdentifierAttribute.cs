namespace Rocks;

/// <summary>
/// Specifies an identifier and a description
/// for a mocked member.
/// </summary>
/// <remarks>
/// This attribute is emitted into members on the mock type
/// so the verification call can get a meaningful stringified description
/// of the member that failed.
///
/// This type is designed to be used from code generated by Rocks,
/// and is not intended for general use. Please refrain from
/// referencing it for any other purposes, as its implementation may change.
/// </remarks>
[AttributeUsage(AttributeTargets.Method | AttributeTargets.Property, AllowMultiple = true, Inherited = false)]
public sealed class MemberIdentifierAttribute
	 : Attribute
{
	/// <summary>
	/// Creates a new <see cref="MemberIdentifierAttribute"/> instance.
	/// </summary>
	/// <param name="value">The identifier.</param>
	public MemberIdentifierAttribute(uint value) => this.Value = value;

	/// <summary>
	/// Creates a new <see cref="MemberIdentifierAttribute"/> instance.
	/// </summary>
	/// <param name="value">The identifier.</param>
	/// <param name="propertyAccessor">The property accessor value if this is used to identify a property.</param>
	public MemberIdentifierAttribute(uint value, PropertyAccessor propertyAccessor) =>
		(this.Value, this.PropertyAccessor) = (value, propertyAccessor);

	/// <summary>
	/// Gets the property accessor.
	/// </summary>
	public PropertyAccessor? PropertyAccessor { get; }

	/// <summary>
	/// Gets the identifier.
	/// </summary>
	public uint Value { get; }
}